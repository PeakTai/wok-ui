import{g as e,m as s}from"./index.6dacb88c.js";import{F as h,I as n}from"./invalid-feedback.de515c0a.js";class l extends h{constructor(t){super(document.createElement("div")),this.opts=t,this.composing=!1,this.input=document.createElement("input"),this.input.type="text",this.input.classList.add("wok-ui-input");const i=s();switch(t.size){case"lg":this.input.style.setProperty("--input-font-size",`${i.textLg}px`);break;case"sm":this.input.style.setProperty("--input-font-size",`${i.textSm}px`);break;default:this.input.style.setProperty("--input-font-size",`${i.text}px`);break}this.addChild(this.input),this.input.placeholder=t.placeholder||"",typeof t.minLength=="number"?this.input.minLength=t.minLength:t.minLength&&(this.input.minLength=t.minLength.minLength),typeof t.maxLength=="number"?this.input.maxLength=t.maxLength:t.maxLength&&(this.input.maxLength=t.maxLength.maxLength),t.required&&(this.input.required=!0),t.value&&(this.input.value=t.value),t.disabled&&(this.input.disabled=!0),t.autofocus&&setTimeout(()=>{this.input.focus()},0),this.input.addEventListener("compositionstart",()=>this.composing=!0),this.input.addEventListener("compositionend",()=>{this.composing=!1,this.handleChange()}),this.input.addEventListener("input",()=>{this.composing||this.handleChange()}),t.onBlur&&this.input.addEventListener("blur",t.onBlur)}handleChange(){this.opts.onChange&&this.opts.onChange(this.input.value),this.validate()}_validate(t){if(this.opts.required&&!t)return{valid:!1,msg:typeof this.opts.required=="string"?this.opts.required:e().buildMsg("form-err-required")};if(!t)return{valid:!0};if(typeof this.opts.minLength=="number"){if(t.length<this.opts.minLength)return{valid:!1,msg:e().buildMsg("form-err-min-length",`${this.opts.minLength}`)}}else if(this.opts.minLength&&t.length<this.opts.minLength.minLength)return{valid:!1,msg:this.opts.minLength.errMsg};if(typeof this.opts.maxLength=="number"){if(t.length>this.opts.maxLength)return{valid:!1,msg:e().buildMsg("form-err-max-length",`${this.opts.maxLength}`)}}else if(this.opts.maxLength&&t.length>this.opts.maxLength.maxLength)return{valid:!1,msg:this.opts.maxLength.errMsg};return this.opts.validator?this.opts.validator(t):{valid:!0}}validate(){const t=this._validate(this.input.value);return this.getChildren().filter(i=>i instanceof n).forEach(i=>i.destroy()),t.valid?this.input.classList.remove("invalid"):(this.input.classList.add("invalid"),this.addChild(new n(t.msg))),t.valid}setDisabled(t){this.input.disabled=t}}export{l as T};
