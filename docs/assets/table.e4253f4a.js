import{M as a,D as w,T as E,F as B,L as b,S as l,H as o,r,P as i,d,l as C,b as D}from"./index.6dd5bfd6.js";import{C as k,B as f}from"./bool-checkbox.b3963482.js";import"./form-input.a55ee7dd.js";class F extends a{constructor(e){super(document.createElement("tr")),e.cols.forEach(t=>{this.addChild(new A({data:e.data,col:t,rowIdx:e.rowIdx}))})}}class A extends a{constructor(e){super(document.createElement("td"));const t=e.col.setting.content(e.data,e.rowIdx);this.addChild(t)}}class p extends a{constructor(e){super(document.createElement("tbody")),this.addChild(...e.list.map((t,n)=>new F({data:t,cols:e.cols,rowIdx:n})))}}class T extends a{constructor(e){super(document.createElement("thead")),this.addChild({tag:"tr",children:e.cols.map(t=>{const n=t.setting.width&&t.setting.width>0?t.setting.width:80;return new y(t.setting.name,n)})})}}class y extends a{constructor(e,t){if(super(document.createElement("th")),this.el.style.width=`${t}px`,typeof e=="string"){this.el.innerText=e;return}this.addChild(e)}}class V extends w{constructor(e){super("kk-table"),e.bordered&&this.el.classList.add("bordered"),this.addChild({tag:"table",children:[new T({cols:e.cols}),new p({table:this,list:e.list,cols:e.cols})]})}}class u{constructor(e){this.setting=e}}class S extends u{constructor(e){let t;e.name||(t=new k({status:"unchecked",onChange:n=>{!t||(t.isChecked()?this.boxes.forEach(c=>c.setStatus("checked")):this.boxes.forEach(c=>c.setStatus("unchecked")),e.onChange&&e.onChange(this.getCheckedValues()))},value:""})),super({name:e.name||t||"",content:(n,c)=>{const m=e.value(n,c),x=e.checked?e.checked(n,c):!1,h=new k({status:x?"checked":"unchecked",value:m,onChange:()=>{const g=this.getCheckedValues();e.onChange&&e.onChange(g),this.updateCheckAllBox()}});return this.boxes.push(h),h},width:30}),this.boxes=[],this.checkAllBox=t}updateCheckAllBox(){if(!this.checkAllBox)return;const e=this.getCheckedValues();e.length===this.boxes.length?this.checkAllBox.setStatus("checked"):e.length===0?this.checkAllBox.setStatus("unchecked"):this.checkAllBox.setStatus("indeterminate")}getCheckedValues(){return this.boxes.filter(e=>e.isChecked()).map(e=>e.value)}checkAll(){this.checkAllBox&&this.checkAllBox.setStatus("checked"),this.boxes.forEach(e=>e.setStatus("checked"))}uncheckAll(){this.checkAllBox&&this.checkAllBox.setStatus("unchecked"),this.boxes.forEach(e=>e.setStatus("unchecked"))}}class v extends u{constructor(){super({name:"#",content:(e,t)=>`${t+1}`,width:30})}}class $ extends B{constructor(){super(),this.list=[{id:"001",name:"\u5F20\u4E09",age:25,city:"\u5317\u4EAC",gender:"\u7537",dept:"\u7814\u53D1\u90E8",status:"\u6FC0\u6D3B"},{id:"002",name:"\u674E\u56DB",age:28,city:"\u4E0A\u6D77",gender:"\u7537",dept:"\u7814\u53D1\u90E8",status:"\u6FC0\u6D3B"},{id:"003",name:"\u738B\u4E94",age:32,city:"\u5E7F\u5DDE",gender:"\u7537",dept:"\u9500\u552E\u90E8",status:"\u51BB\u7ED3"},{id:"004",name:"\u9A6C\u516D",age:33,city:"\u6DF1\u5733",gender:"\u7537",dept:"\u7814\u53D1\u90E8",status:"\u6FC0\u6D3B"}],this.checkedVals=[],this.bordered=!0,this.render()}buildContent(){this.addChild(new b("\u8868\u683C"),new l(20),new o({gap:r(1),children:[new f({label:"\u663E\u793A\u8FB9\u6846",value:this.bordered,onChange:e=>{this.bordered=e,this.removeCache("table"),this.render()}}),new i(this.checkedVals?`\u5DF2\u9009\u62E9\uFF1A${JSON.stringify(this.checkedVals)}`:"\u672A\u9009\u62E9\u4EFB\u4F55\u6761\u76EE")]}),new l(10),this.cacheModule({key:"table",module:()=>new V({bordered:this.bordered,list:this.list,cols:[new S({value:e=>e.id,onChange:e=>{this.checkedVals=e,this.render()},checked:e=>this.checkedVals.includes(e.id)}),new v,new u({name:"\u59D3\u540D",content:e=>e.name,width:100}),new u({name:"\u5E74\u9F84",content:e=>`${e.age}`}),new u({name:"\u6027\u522B",content:e=>`${e.gender}`,width:60}),new u({name:"\u57CE\u5E02",content:e=>`${e.city}`,width:80}),new u({name:"\u90E8\u95E8",content:e=>`${e.dept}`,width:100}),new u({name:"\u79EF\u5206",content:e=>new M(e),width:100}),new u({name:"\u72B6\u6001",width:80,content:e=>e.status==="\u6FC0\u6D3B"?new i("\u6FC0\u6D3B").setColor(d().success):new i("\u51BB\u7ED3").setColor(d().danger)}),new u({name:"\u64CD\u4F5C",content:e=>new o({gap:r(.5),children:[new C({content:e.status==="\u6FC0\u6D3B"?"\u51BB\u7ED3":"\u6FC0\u6D3B",onClick:()=>{e.status=e.status==="\u6FC0\u6D3B"?"\u51BB\u7ED3":"\u6FC0\u6D3B",this.removeCache("table"),this.render()}}),new C({content:"\u5220\u9664",onClick:()=>{if(!confirm("\u786E\u5B9A\u8981\u5220\u9664\u6761\u76EE\u5417"))return;const t=this.list.indexOf(e);this.list.splice(t,1);const n=this.checkedVals.indexOf(e.id);n!==-1&&this.checkedVals.splice(n,1),this.removeCache("table"),this.render()}})]}),width:100})]})}))}}class M extends w{constructor(e){super(),this.addChild("\u52A0\u8F7D\u4E2D..."),setTimeout(()=>{this.empty();const t=Math.random()*1e3;if(t<500){this.addChild(new D({text:`\u52A0\u8F7D${e.name}\u7684\u79EF\u5206\u5931\u8D25`,color:d().danger}));return}this.addChild(t.toFixed(1))},2e3)}}function H(){return new E(new $)}export{H as tableTest};
