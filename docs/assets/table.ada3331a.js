var C=(s,e,t)=>{if(!e.has(s))throw TypeError("Cannot "+t)};var u=(s,e,t)=>(C(s,e,"read from private field"),t?t.call(s):e.get(s)),r=(s,e,t)=>{if(e.has(s))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(s):e.set(s,t)},k=(s,e,t,n)=>(C(s,e,"write to private field"),n?n.call(s,t):e.set(s,t),t);var E=(s,e,t)=>(C(s,e,"access private method"),t);import{M as l,b as A,d as w,s as V,D as S,T as v,F as $,L as M,S as x,H as f,r as D,P as m,l as B}from"./index.0f65c826.js";import{C as b,B as I}from"./bool-checkbox.28b21e59.js";import"./invalid-feedback.11287e18.js";class L extends l{constructor(e){super(document.createElement("tr")),e.cols.forEach(t=>{this.addChild(new P({data:e.data,col:t,rowIdx:e.rowIdx}))})}}class P extends l{constructor(e){super(document.createElement("td"));const t=e.col.setting.content(e.data,e.rowIdx);t instanceof Promise?(this.el.innerText="\u52A0\u8F7D\u4E2D...",t.then(n=>{this.el.innerText="",typeof n=="string"?this.el.innerText=n:this.addChild(n)}).catch(n=>{this.el.innerText="",this.addChild(new A({text:"\u52A0\u8F7D\u5931\u8D25",color:w().danger})),V(n)})):this.addChild(t)}}class H extends l{constructor(e){super(document.createElement("tbody")),this.addChild(...e.list.map((t,n)=>new L({data:t,cols:e.cols,rowIdx:n})))}}class O extends l{constructor(e){super(document.createElement("thead")),this.addChild({tag:"tr",children:e.cols.map(t=>{const n=t.setting.width&&t.setting.width>0?t.setting.width:80;return new R(t.setting.name,n)})})}}class R extends l{constructor(e,t){if(super(document.createElement("th")),this.el.style.width=`${t}px`,typeof e=="string"){this.el.innerText=e;return}this.addChild(e)}}class J extends S{constructor(e){super("kk-table"),e.bordered&&this.el.classList.add("bordered"),this.addChild({tag:"table",children:[new O({cols:e.cols}),new H({table:this,list:e.list,cols:e.cols})]})}}class c{constructor(e){this.setting=e}}var i,a,o,F;class N extends c{constructor(t){let n;t.name||(n=new b({status:"unchecked",onChange:d=>{!n||(n.isChecked()?u(this,a).forEach(h=>h.setStatus("checked")):u(this,a).forEach(h=>h.setStatus("unchecked")),t.onChange&&t.onChange(this.getCheckedValues()))},value:""}));super({name:t.name||n||"",content:(d,h)=>{const T=t.value(d,h),p=t.checked?t.checked(d,h):!1,g=new b({status:p?"checked":"unchecked",value:T,onChange:()=>{const y=this.getCheckedValues();t.onChange&&t.onChange(y),E(this,o,F).call(this)}});return u(this,a).push(g),g},width:30});r(this,o);r(this,i,void 0);r(this,a,[]);k(this,i,n)}getCheckedValues(){return u(this,a).filter(t=>t.isChecked()).map(t=>t.value)}checkAll(){u(this,i)&&u(this,i).setStatus("checked"),u(this,a).forEach(t=>t.setStatus("checked"))}uncheckAll(){u(this,i)&&u(this,i).setStatus("unchecked"),u(this,a).forEach(t=>t.setStatus("unchecked"))}}i=new WeakMap,a=new WeakMap,o=new WeakSet,F=function(){if(!u(this,i))return;const t=this.getCheckedValues();t.length===u(this,a).length?u(this,i).setStatus("checked"):t.length===0?u(this,i).setStatus("unchecked"):u(this,i).setStatus("indeterminate")};class W extends c{constructor(){super({name:"#",content:(e,t)=>`${t+1}`,width:30})}}class j extends ${constructor(){super(),this.list=[{id:"001",name:"\u5F20\u4E09",age:25,city:"\u5317\u4EAC",gender:"\u7537",dept:"\u7814\u53D1\u90E8",status:"\u6FC0\u6D3B"},{id:"002",name:"\u674E\u56DB",age:28,city:"\u4E0A\u6D77",gender:"\u7537",dept:"\u7814\u53D1\u90E8",status:"\u6FC0\u6D3B"},{id:"003",name:"\u738B\u4E94",age:32,city:"\u5E7F\u5DDE",gender:"\u7537",dept:"\u9500\u552E\u90E8",status:"\u51BB\u7ED3"},{id:"004",name:"\u9A6C\u516D",age:33,city:"\u6DF1\u5733",gender:"\u7537",dept:"\u7814\u53D1\u90E8",status:"\u6FC0\u6D3B"}],this.checkedVals=[],this.bordered=!0,this.render()}buildContent(){this.addChild(new M("\u8868\u683C"),new x(20),new f({gap:D(1),children:[new I({label:"\u663E\u793A\u8FB9\u6846",value:this.bordered,onChange:e=>{this.bordered=e,this.removeCache("table"),this.render()}}),new m(this.checkedVals?`\u5DF2\u9009\u62E9\uFF1A${JSON.stringify(this.checkedVals)}`:"\u672A\u9009\u62E9\u4EFB\u4F55\u6761\u76EE")]}),new x(10),this.cacheModule({key:"table",module:()=>new J({bordered:this.bordered,list:this.list,cols:[new N({value:e=>e.id,onChange:e=>{this.checkedVals=e,this.render()},checked:e=>this.checkedVals.includes(e.id)}),new W,new c({name:"\u59D3\u540D",content:e=>e.name}),new c({name:"\u5E74\u9F84",content:e=>`${e.age}`}),new c({name:"\u6027\u522B",content:e=>`${e.gender}`,width:60}),new c({name:"\u57CE\u5E02",content:e=>`${e.city}`}),new c({name:"\u90E8\u95E8",content:e=>`${e.dept}`,width:100}),new c({name:"\u79EF\u5206",content:e=>new Promise((t,n)=>{setTimeout(()=>{const d=Math.random()*1e3;if(d<500){n(`\u52A0\u8F7D${e.name}\u7684\u79EF\u5206\u5931\u8D25`);return}t(d.toFixed(1))},2e3)})}),new c({name:"\u72B6\u6001",content:e=>e.status==="\u6FC0\u6D3B"?new m("\u6FC0\u6D3B").setColor(w().success):new m("\u51BB\u7ED3").setColor(w().danger)}),new c({name:"\u64CD\u4F5C",content:e=>new f({gap:D(.5),children:[new B({content:e.status==="\u6FC0\u6D3B"?"\u51BB\u7ED3":"\u6FC0\u6D3B",onClick:()=>{e.status=e.status==="\u6FC0\u6D3B"?"\u51BB\u7ED3":"\u6FC0\u6D3B",this.removeCache("table"),this.render()}}),new B({content:"\u5220\u9664",onClick:()=>{if(!confirm("\u786E\u5B9A\u8981\u5220\u9664\u6761\u76EE\u5417"))return;const t=this.list.indexOf(e);this.list.splice(t,1);const n=this.checkedVals.indexOf(e.id);n!==-1&&this.checkedVals.splice(n,1),this.removeCache("table"),this.render()}})]}),width:100})]})}))}}function Q(){return new v(new j)}export{Q as tableTest};
