var g=(i,s,e)=>{if(!s.has(i))throw TypeError("Cannot "+e)};var o=(i,s,e)=>(g(i,s,"read from private field"),e?e.call(i):s.get(i)),l=(i,s,e)=>{if(s.has(i))throw TypeError("Cannot add the same private member more than once");s instanceof WeakSet?s.add(i):s.set(i,e)},d=(i,s,e,t)=>(g(i,s,"write to private field"),t?t.call(i,e):s.set(i,e),e);import{D as C,j as x,k as y,A as w,s as f,B as k,g as D}from"./index.0f65c826.js";var h;class N extends C{constructor(e){super("wok-ui-modal");l(this,h,void 0);d(this,h,e)}addDialog(e){e.onDestroy(()=>{this.getChildren().length===0&&this.destroy()}),this.addChild(e)}async closeAllModals(){const e=this.getChildren();for(const t of e)await t.close()}removeChild(e){const t=super.removeChild(e);return this.getChildren().length===0&&this.destroy(),t}destroy(){super.destroy(),o(this,h).onDestroy()}}h=new WeakMap;var u,a,n;class R extends C{constructor(e){super("wok-ui-modal-dialog",x);l(this,u,!1);l(this,a,void 0);l(this,n,void 0);if(d(this,n,e),y({el:this.el,animation:w.SLIDE_TOP,duration:300}).then(()=>{e.onShown&&e.onShown()}),o(this,n).fullscreen?this.el.classList.add("fullscreen"):o(this,n).dialogCentered&&this.el.classList.add("centered"),this.el.addEventListener("click",t=>{t.stopPropagation(),this.tryDestroy()}),e.replaceByBody){this.addChild({classNames:["wok-ui-modal-content"],style:{borderRadius:e.borderRadius&&e.borderRadius>0?`${e.borderRadius}px`:void 0,width:e.fullscreen?void 0:e.width&&e.width>0?`${e.width}px`:"500px"},onClick(t){t.stopPropagation()},children:e.body});return}this.addChild({classNames:["wok-ui-modal-content","normal"],style:{borderRadius:e.borderRadius&&e.borderRadius>0?`${e.borderRadius}px`:void 0,width:e.fullscreen?void 0:e.width&&e.width>0?`${e.width}px`:"500px"},onClick(t){t.stopPropagation()},children:t=>{if(e.title&&t({classNames:["wok-ui-modal-header"],children:r=>{r({classNames:["title"],innerText:e.title}),e.closeBtn!==!1&&r({classNames:["close"],innerHTML:"&times;",onClick:()=>{this.close().catch(f)}})}}),t({classNames:["wok-ui-modal-body"],children:e.body}),e.footer)t(e.footer);else if(e.buttons&&(e.buttons.cancel||e.buttons.confirm)){const{confirm:r,cancel:m}=e.buttons;t({classNames:["wok-ui-modal-footer"],children:b=>{r&&b(new k({text:typeof r=="string"?r:D().buildMsg("confirm"),type:"primary",onClick(v){e.onConfirm&&e.onConfirm()}})),m&&b(new k({text:typeof m=="string"?m:D().buildMsg("cancel"),onClick:v=>this.close().catch(f)}))}})}}})}tryDestroy(){if(o(this,n).staticBackDrop){y({el:this.el,animation:w.SHAKE}).catch(f);return}this.close().catch(f)}onDestroy(e){d(this,a,e)}async close(){await y({el:this.el,animation:w.SLIDE_TOP,duration:300,reverse:!0}),this.destroy(),o(this,a)&&o(this,a).call(this),o(this,n).onClose&&!o(this,u)&&(o(this,n).onClose(),d(this,u,!0))}}u=new WeakMap,a=new WeakMap,n=new WeakMap;let c;function L(i){c||(c=new N({onDestroy:()=>c=void 0}),c.mount(document.body));const s=new R(i);return c.addDialog(s),{close:()=>s.close()}}export{L as s};
